<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>sumOfSquares: Класс Authenticator</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">sumOfSquares<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Создано системой Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Поиск','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Поиск');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Открытые члены</a> &#124;
<a href="#pri-attribs">Закрытые данные</a> &#124;
<a href="classAuthenticator-members.html">Полный список членов класса</a>  </div>
  <div class="headertitle"><div class="title">Класс Authenticator</div></div>
</div><!--header-->
<div class="contents">

<p>Обрабатывает аутентификацию пользователей по базе данных.  
 <a href="classAuthenticator.html#details">Подробнее...</a></p>

<p><code>#include &lt;<a class="el" href="Auth_8h_source.html">Auth.h</a>&gt;</code></p>
<div class="dynheader">
Граф связей класса Authenticator:</div>
<div class="dyncontent">
<div class="center"><img src="classAuthenticator__coll__graph.png" border="0" usemap="#aAuthenticator_coll__map" alt="Collaboration graph"/></div>
<map name="aAuthenticator_coll__map" id="aAuthenticator_coll__map">
<area shape="rect" title="Обрабатывает аутентификацию пользователей по базе данных." alt="" coords="70,95,181,121"/>
<area shape="rect" href="classClientDataBase.html" title="Класс для работы с базой данных клиентов, хранящей логины и пароли." alt="" coords="5,5,128,32"/>
<area shape="rect" href="classLogger.html" title="Класс для ведения логов в файл." alt="" coords="152,5,219,32"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">см. легенду</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Открытые члены</h2></td></tr>
<tr class="memitem:a475d02077f906548de3db7593af8f229"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAuthenticator.html#a475d02077f906548de3db7593af8f229">Authenticator</a> (const std::string &amp;db_filename, <a class="el" href="classLogger.html">Logger</a> &amp;<a class="el" href="classAuthenticator.html#a5528e6dba1ae44cb483f4b3a1cb1ba0a">logger</a>)</td></tr>
<tr class="memdesc:a475d02077f906548de3db7593af8f229"><td class="mdescLeft">&#160;</td><td class="mdescRight">Конструктор объекта <a class="el" href="classAuthenticator.html" title="Обрабатывает аутентификацию пользователей по базе данных.">Authenticator</a>.  <a href="classAuthenticator.html#a475d02077f906548de3db7593af8f229">Подробнее...</a><br /></td></tr>
<tr class="separator:a475d02077f906548de3db7593af8f229"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acbea4bff4ba3c6f2a8830c72f689de61"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAuthenticator.html#acbea4bff4ba3c6f2a8830c72f689de61">isLoginExists</a> (const std::string &amp;login)</td></tr>
<tr class="memdesc:acbea4bff4ba3c6f2a8830c72f689de61"><td class="mdescLeft">&#160;</td><td class="mdescRight">Проверяет, существует ли логин в базе данных.  <a href="classAuthenticator.html#acbea4bff4ba3c6f2a8830c72f689de61">Подробнее...</a><br /></td></tr>
<tr class="separator:acbea4bff4ba3c6f2a8830c72f689de61"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4c0768438bedfa0c65b8036269793d9"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAuthenticator.html#af4c0768438bedfa0c65b8036269793d9">generateSalt</a> ()</td></tr>
<tr class="memdesc:af4c0768438bedfa0c65b8036269793d9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Генерирует случайную соль длиной 16 символов в шестнадцатеричном формате.  <a href="classAuthenticator.html#af4c0768438bedfa0c65b8036269793d9">Подробнее...</a><br /></td></tr>
<tr class="separator:af4c0768438bedfa0c65b8036269793d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aedc5aa2e8c7b90d366f0cfdb56f37fee"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAuthenticator.html#aedc5aa2e8c7b90d366f0cfdb56f37fee">hashPassword</a> (const std::string &amp;salt_16, const std::string &amp;password)</td></tr>
<tr class="memdesc:aedc5aa2e8c7b90d366f0cfdb56f37fee"><td class="mdescLeft">&#160;</td><td class="mdescRight">Хэширует пароль с использованием SHA224 и заданной солью.  <a href="classAuthenticator.html#aedc5aa2e8c7b90d366f0cfdb56f37fee">Подробнее...</a><br /></td></tr>
<tr class="separator:aedc5aa2e8c7b90d366f0cfdb56f37fee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af398c33e9d40b326eb4b2f98eebe4e52"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAuthenticator.html#af398c33e9d40b326eb4b2f98eebe4e52">compareHashes</a> (const std::string &amp;clientHash, const std::string &amp;salt, const std::string &amp;login)</td></tr>
<tr class="memdesc:af398c33e9d40b326eb4b2f98eebe4e52"><td class="mdescLeft">&#160;</td><td class="mdescRight">Сравнивает полученный от клиента хэш с сгенерированным на сервере.  <a href="classAuthenticator.html#af398c33e9d40b326eb4b2f98eebe4e52">Подробнее...</a><br /></td></tr>
<tr class="separator:af398c33e9d40b326eb4b2f98eebe4e52"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af977d54ed3a7e8ba64527d01c26b80c4"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAuthenticator.html#af977d54ed3a7e8ba64527d01c26b80c4">verifyPassword</a> (const std::string &amp;login, const std::string &amp;password, const std::string &amp;salt)</td></tr>
<tr class="memdesc:af977d54ed3a7e8ba64527d01c26b80c4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Проверяет пароль пользователя в базе данных.  <a href="classAuthenticator.html#af977d54ed3a7e8ba64527d01c26b80c4">Подробнее...</a><br /></td></tr>
<tr class="separator:af977d54ed3a7e8ba64527d01c26b80c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-attribs" name="pri-attribs"></a>
Закрытые данные</h2></td></tr>
<tr class="memitem:af1d954a93820c0fe7510c1e25523970b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classClientDataBase.html">ClientDataBase</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAuthenticator.html#af1d954a93820c0fe7510c1e25523970b">db</a></td></tr>
<tr class="memdesc:af1d954a93820c0fe7510c1e25523970b"><td class="mdescLeft">&#160;</td><td class="mdescRight">База данных для хранения учетных данных пользователей.  <a href="classAuthenticator.html#af1d954a93820c0fe7510c1e25523970b">Подробнее...</a><br /></td></tr>
<tr class="separator:af1d954a93820c0fe7510c1e25523970b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5528e6dba1ae44cb483f4b3a1cb1ba0a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classLogger.html">Logger</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAuthenticator.html#a5528e6dba1ae44cb483f4b3a1cb1ba0a">logger</a></td></tr>
<tr class="memdesc:a5528e6dba1ae44cb483f4b3a1cb1ba0a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Объект логгера для записи событий аутентификации.  <a href="classAuthenticator.html#a5528e6dba1ae44cb483f4b3a1cb1ba0a">Подробнее...</a><br /></td></tr>
<tr class="separator:a5528e6dba1ae44cb483f4b3a1cb1ba0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Подробное описание</h2>
<div class="textblock"><p >Обрабатывает аутентификацию пользователей по базе данных. </p>
</div><h2 class="groupheader">Конструктор(ы)</h2>
<a id="a475d02077f906548de3db7593af8f229" name="a475d02077f906548de3db7593af8f229"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a475d02077f906548de3db7593af8f229">&#9670;&nbsp;</a></span>Authenticator()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Authenticator::Authenticator </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>db_filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classLogger.html">Logger</a> &amp;&#160;</td>
          <td class="paramname"><em>logger</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Конструктор объекта <a class="el" href="classAuthenticator.html" title="Обрабатывает аутентификацию пользователей по базе данных.">Authenticator</a>. </p>
<dl class="params"><dt>Аргументы</dt><dd>
  <table class="params">
    <tr><td class="paramname">db_filename</td><td>Путь к файлу базы данных. </td></tr>
    <tr><td class="paramname">logger</td><td>Ссылка на объект логгера. </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><span class="lineno">    7</span>    : <a class="code hl_variable" href="classAuthenticator.html#af1d954a93820c0fe7510c1e25523970b">db</a>(db_filename), <a class="code hl_variable" href="classAuthenticator.html#a5528e6dba1ae44cb483f4b3a1cb1ba0a">logger</a>(<a class="code hl_variable" href="classAuthenticator.html#a5528e6dba1ae44cb483f4b3a1cb1ba0a">logger</a>) </div>
<div class="line"><span class="lineno">    8</span>{</div>
<div class="line"><span class="lineno">    9</span>}</div>
<div class="ttc" id="aclassAuthenticator_html_a5528e6dba1ae44cb483f4b3a1cb1ba0a"><div class="ttname"><a href="classAuthenticator.html#a5528e6dba1ae44cb483f4b3a1cb1ba0a">Authenticator::logger</a></div><div class="ttdeci">Logger &amp; logger</div><div class="ttdoc">Объект логгера для записи событий аутентификации.</div><div class="ttdef"><b>Definition:</b> Auth.h:31</div></div>
<div class="ttc" id="aclassAuthenticator_html_af1d954a93820c0fe7510c1e25523970b"><div class="ttname"><a href="classAuthenticator.html#af1d954a93820c0fe7510c1e25523970b">Authenticator::db</a></div><div class="ttdeci">ClientDataBase db</div><div class="ttdoc">База данных для хранения учетных данных пользователей.</div><div class="ttdef"><b>Definition:</b> Auth.h:30</div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Методы</h2>
<a id="af398c33e9d40b326eb4b2f98eebe4e52" name="af398c33e9d40b326eb4b2f98eebe4e52"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af398c33e9d40b326eb4b2f98eebe4e52">&#9670;&nbsp;</a></span>compareHashes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool Authenticator::compareHashes </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>clientHash</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>salt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>login</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Сравнивает полученный от клиента хэш с сгенерированным на сервере. </p>
<dl class="params"><dt>Аргументы</dt><dd>
  <table class="params">
    <tr><td class="paramname">clientHash</td><td>Хэш, полученный от клиента. </td></tr>
    <tr><td class="paramname">salt</td><td>Соль, использованная для хэширования. </td></tr>
    <tr><td class="paramname">login</td><td>Логин пользователя. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Возвращает</dt><dd>True, если хэши совпадают, иначе false. </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">   46</span>{</div>
<div class="line"><span class="lineno">   47</span>    <span class="keywordtype">string</span> password = <a class="code hl_variable" href="classAuthenticator.html#af1d954a93820c0fe7510c1e25523970b">db</a>[login];</div>
<div class="line"><span class="lineno">   48</span>    <a class="code hl_variable" href="classAuthenticator.html#a5528e6dba1ae44cb483f4b3a1cb1ba0a">logger</a>.<a class="code hl_function" href="classLogger.html#a3d3f0801eeaf39b33a906ea8569c19b2">log</a>(<a class="code hl_enumvalue" href="Logger_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a748005382152808a72b1a9177d9dc806">INFO</a>, <span class="stringliteral">&quot;Хэш от клиента: &quot;</span> + clientHash);</div>
<div class="line"><span class="lineno">   49</span>    std::string generatedHash = <a class="code hl_function" href="classAuthenticator.html#aedc5aa2e8c7b90d366f0cfdb56f37fee">hashPassword</a>(salt, password);</div>
<div class="line"><span class="lineno">   50</span>     <a class="code hl_variable" href="classAuthenticator.html#a5528e6dba1ae44cb483f4b3a1cb1ba0a">logger</a>.<a class="code hl_function" href="classLogger.html#a3d3f0801eeaf39b33a906ea8569c19b2">log</a>(<a class="code hl_enumvalue" href="Logger_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a748005382152808a72b1a9177d9dc806">INFO</a>, <span class="stringliteral">&quot;Cравниваю хэши (Сервер == клиент): &quot;</span> + generatedHash + <span class="stringliteral">&quot; == &quot;</span> + clientHash );</div>
<div class="line"><span class="lineno">   51</span>    <span class="keywordflow">return</span> generatedHash == clientHash;</div>
<div class="line"><span class="lineno">   52</span>}</div>
<div class="ttc" id="aLogger_8h_html_aca1fd1d8935433e6ba2e3918214e07f9a748005382152808a72b1a9177d9dc806"><div class="ttname"><a href="Logger_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a748005382152808a72b1a9177d9dc806">INFO</a></div><div class="ttdeci">@ INFO</div><div class="ttdoc">Информационное сообщение</div><div class="ttdef"><b>Definition:</b> Logger.h:23</div></div>
<div class="ttc" id="aclassAuthenticator_html_aedc5aa2e8c7b90d366f0cfdb56f37fee"><div class="ttname"><a href="classAuthenticator.html#aedc5aa2e8c7b90d366f0cfdb56f37fee">Authenticator::hashPassword</a></div><div class="ttdeci">std::string hashPassword(const std::string &amp;salt_16, const std::string &amp;password)</div><div class="ttdoc">Хэширует пароль с использованием SHA224 и заданной солью.</div><div class="ttdef"><b>Definition:</b> Auth.cpp:32</div></div>
<div class="ttc" id="aclassLogger_html_a3d3f0801eeaf39b33a906ea8569c19b2"><div class="ttname"><a href="classLogger.html#a3d3f0801eeaf39b33a906ea8569c19b2">Logger::log</a></div><div class="ttdeci">void log(LogLevel level, const std::string &amp;message)</div><div class="ttdoc">Записывает сообщение в лог-файл.</div><div class="ttdef"><b>Definition:</b> Logger.cpp:63</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af4c0768438bedfa0c65b8036269793d9" name="af4c0768438bedfa0c65b8036269793d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af4c0768438bedfa0c65b8036269793d9">&#9670;&nbsp;</a></span>generateSalt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">string Authenticator::generateSalt </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Генерирует случайную соль длиной 16 символов в шестнадцатеричном формате. </p>
<dl class="section return"><dt>Возвращает</dt><dd>Сгенерированная соль. </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">   16</span>{</div>
<div class="line"><span class="lineno">   17</span>    <span class="keyword">namespace </span>CPP = CryptoPP;</div>
<div class="line"><span class="lineno">   18</span>    <span class="keyword">constexpr</span> <span class="keywordtype">int</span> salt_size = 8; <span class="comment">// 64 бита = 8 байт</span></div>
<div class="line"><span class="lineno">   19</span>    CPP::byte salt[salt_size];</div>
<div class="line"><span class="lineno">   20</span>    CPP::AutoSeededRandomPool prng;</div>
<div class="line"><span class="lineno">   21</span>    prng.GenerateBlock(salt, salt_size);</div>
<div class="line"><span class="lineno">   22</span>    std::string salt_16;</div>
<div class="line"><span class="lineno">   23</span>    CPP::ArraySource(salt, salt_size, <span class="keyword">true</span>, <span class="keyword">new</span> CPP::HexEncoder(<span class="keyword">new</span> CPP::StringSink(salt_16)));</div>
<div class="line"><span class="lineno">   24</span> </div>
<div class="line"><span class="lineno">   25</span>    <span class="comment">//тут  дополняем слева нулями до 16 символов</span></div>
<div class="line"><span class="lineno">   26</span>    <span class="keywordflow">while</span>(salt_16.length() &lt; 16) {</div>
<div class="line"><span class="lineno">   27</span>        salt_16.insert(salt_16.begin(), <span class="charliteral">&#39;0&#39;</span>);</div>
<div class="line"><span class="lineno">   28</span>    }</div>
<div class="line"><span class="lineno">   29</span>    <span class="keywordflow">return</span> salt_16;</div>
<div class="line"><span class="lineno">   30</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aedc5aa2e8c7b90d366f0cfdb56f37fee" name="aedc5aa2e8c7b90d366f0cfdb56f37fee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aedc5aa2e8c7b90d366f0cfdb56f37fee">&#9670;&nbsp;</a></span>hashPassword()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">string Authenticator::hashPassword </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>salt_16</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>password</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Хэширует пароль с использованием SHA224 и заданной солью. </p>
<dl class="params"><dt>Аргументы</dt><dd>
  <table class="params">
    <tr><td class="paramname">salt_16</td><td>Соль длиной 16 символов в шестнадцатеричном формате. </td></tr>
    <tr><td class="paramname">password</td><td>Пароль для хэширования. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Возвращает</dt><dd>Хэш SHA224 пароля, конкатенированного с солью. </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">   33</span>{</div>
<div class="line"><span class="lineno">   34</span>    <span class="keyword">namespace </span>CPP = CryptoPP;</div>
<div class="line"><span class="lineno">   35</span>    <span class="keywordtype">string</span> HashAndPass = salt_16 + password; </div>
<div class="line"><span class="lineno">   36</span>    CPP::SHA224 hash;                        </div>
<div class="line"><span class="lineno">   37</span>    CPP::byte digest[CryptoPP::SHA224::DIGESTSIZE];</div>
<div class="line"><span class="lineno">   38</span>    hash.CalculateDigest(digest, (<span class="keyword">const</span> CPP::byte*)HashAndPass.data(), HashAndPass.size());</div>
<div class="line"><span class="lineno">   39</span>    <span class="keywordtype">string</span> Hash;</div>
<div class="line"><span class="lineno">   40</span>    CryptoPP::StringSource(digest, <span class="keyword">sizeof</span>(digest), <span class="keyword">true</span>, <span class="keyword">new</span> CryptoPP::HexEncoder(<span class="keyword">new</span> CryptoPP::StringSink(Hash)));</div>
<div class="line"><span class="lineno">   41</span>    <a class="code hl_variable" href="classAuthenticator.html#a5528e6dba1ae44cb483f4b3a1cb1ba0a">logger</a>.<a class="code hl_function" href="classLogger.html#a3d3f0801eeaf39b33a906ea8569c19b2">log</a>(<a class="code hl_enumvalue" href="Logger_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a748005382152808a72b1a9177d9dc806">INFO</a>, <span class="stringliteral">&quot;Сервер сгенерировал хэш: &quot;</span>+ Hash);</div>
<div class="line"><span class="lineno">   42</span>    <span class="keywordflow">return</span> Hash;</div>
<div class="line"><span class="lineno">   43</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="acbea4bff4ba3c6f2a8830c72f689de61" name="acbea4bff4ba3c6f2a8830c72f689de61"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acbea4bff4ba3c6f2a8830c72f689de61">&#9670;&nbsp;</a></span>isLoginExists()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool Authenticator::isLoginExists </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>login</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Проверяет, существует ли логин в базе данных. </p>
<dl class="params"><dt>Аргументы</dt><dd>
  <table class="params">
    <tr><td class="paramname">login</td><td>Логин пользователя для проверки. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Возвращает</dt><dd>True, если логин существует, иначе false. </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">   12</span>{</div>
<div class="line"><span class="lineno">   13</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="classAuthenticator.html#af1d954a93820c0fe7510c1e25523970b">db</a>.<a class="code hl_function" href="classClientDataBase.html#a1deb355b82988dd27db7b07c54fcee84">isLoginExists</a>(login); </div>
<div class="line"><span class="lineno">   14</span>}</div>
<div class="ttc" id="aclassClientDataBase_html_a1deb355b82988dd27db7b07c54fcee84"><div class="ttname"><a href="classClientDataBase.html#a1deb355b82988dd27db7b07c54fcee84">ClientDataBase::isLoginExists</a></div><div class="ttdeci">bool isLoginExists(const std::string &amp;login)</div><div class="ttdoc">Проверяет существование логина в базе данных.</div><div class="ttdef"><b>Definition:</b> ClientDataBase.cpp:14</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af977d54ed3a7e8ba64527d01c26b80c4" name="af977d54ed3a7e8ba64527d01c26b80c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af977d54ed3a7e8ba64527d01c26b80c4">&#9670;&nbsp;</a></span>verifyPassword()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool Authenticator::verifyPassword </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>login</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>password</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>salt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Проверяет пароль пользователя в базе данных. </p>
<dl class="params"><dt>Аргументы</dt><dd>
  <table class="params">
    <tr><td class="paramname">login</td><td>Логин пользователя. </td></tr>
    <tr><td class="paramname">password</td><td>Пароль пользователя. </td></tr>
    <tr><td class="paramname">salt</td><td>Соль, связанная с паролем пользователя. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Возвращает</dt><dd>True, если пароль валиден, иначе false. </dd></dl>

</div>
</div>
<h2 class="groupheader">Данные класса</h2>
<a id="af1d954a93820c0fe7510c1e25523970b" name="af1d954a93820c0fe7510c1e25523970b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af1d954a93820c0fe7510c1e25523970b">&#9670;&nbsp;</a></span>db</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classClientDataBase.html">ClientDataBase</a> Authenticator::db</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>База данных для хранения учетных данных пользователей. </p>

</div>
</div>
<a id="a5528e6dba1ae44cb483f4b3a1cb1ba0a" name="a5528e6dba1ae44cb483f4b3a1cb1ba0a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5528e6dba1ae44cb483f4b3a1cb1ba0a">&#9670;&nbsp;</a></span>logger</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classLogger.html">Logger</a>&amp; Authenticator::logger</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Объект логгера для записи событий аутентификации. </p>

</div>
</div>
<hr/>Объявления и описания членов классов находятся в файлах:<ul>
<li><a class="el" href="Auth_8h_source.html">Auth.h</a></li>
<li><a class="el" href="Auth_8cpp.html">Auth.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Создано системой&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4
</small></address>
</body>
</html>
